language: cpp
sudo: required
cache: ccache

# Travis CI environmental variables -> 2 env variables
env:
    global:
    matrix:
      - TRAVIS_BUILD_TYPE=Debug
      - TRAVIS_BUILD_TYPE=Release

matrix:
  include:
    # works on Precise and Trusty
    - os: linux
      dist: trusty
        addons:
            apt:
                sources:
                    - ubuntu-toolchain-r-test
                packages:
                    - g++-7
            env:
                - MATRIX_EVAL="CC=gcc-7 && CXX=g++-7"
    - os: linux
      dist: trusty
        addons:
            apt:
                sources:
                    - llvm-toolchain-trusty-5.0
                packages:
                    - clang-5.0
            env:
                - MATRIX_EVAL="CC=clang-5.0 && CXX=clang++-5.0"
    # works on Mac OS xcode9.4
    - os: osx
      osx_image: xcode9.4
        env:
            - MATRIX_EVAL="brew install gcc && CC=gcc-7 && CXX=g++-7"
    - os: osx
      osx_image: xcode9.4
        env:
            # default to clang
            - MATRIX_EVAL=""

before_install:
    - eval "${MATRIX_EVAL}"

    # Update package managers
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then sudo apt-get -qq update;  fi
    - if [ "$TRAVIS_OS_NAME" == "osx"   ]; then brew update;              fi

    # Use ccache also for clang and clang++ on linux
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then if [ "$CC" == "clang" ];    then sudo ln -s ../../bin/ccache /usr/lib/ccache/clang;   fi; fi
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then if [ "$CC" == "clang" ];    then export CFLAGS="-Qunused-arguments";                  fi; fi
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then if [ "$CXX" == "clang++" ]; then sudo ln -s ../../bin/ccache /usr/lib/ccache/clang++; fi; fi
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then if [ "$CXX" == "clang++" ]; then export CXXFLAGS="-Qunused-arguments";                fi; fi

    # Install ccache on osx
    - if [ "$TRAVIS_OS_NAME" == "osx" ]; then brew install ccache;                               fi
    - if [ "$TRAVIS_OS_NAME" == "osx" ]; then export PATH="/usr/local/opt/ccache/libexec:$PATH"; fi

    # Print some more system information after installing all build tools
    - echo "-------------------- BEGIN SYSTEM INFORMATION --------------------"
    - uname -a
    - if [ "$TRAVIS_OS_NAME" == "linux" ]; then lsb_release -a;                     fi
    - if [ "$TRAVIS_OS_NAME" == "osx" ];   then system_profiler SPSoftwareDataType; fi
    - env
    - which cmake
    - cmake --version
    - which $CC
    - $CC --version
    - which $CXX
    - $CXX --version
    - which ccache
    - ccache --version
    - ccache -s
    - echo "--------------------  END SYSTEM INFORMATION  --------------------"

install:

before_script:
    - mkdir build
    - cd build
    - cmake -DBUILD_TESTING:BOOL=ON -DCMAKE_BUILD_TYPE=${TRAVIS_BUILD_TYPE} ..

script:
    - make
    - make test
    - make doc

after_success:

after_failure:

before_deploy:
deploy:
after_deploy:

after_script: